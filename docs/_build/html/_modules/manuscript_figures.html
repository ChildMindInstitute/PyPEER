
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>manuscript_figures &#8212; peer  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for manuscript_figures</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Sat May 26 11:02:35 2018</span>

<span class="sd">@author: json</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">spearmanr</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="k">import</span> <span class="n">ols</span>

<span class="n">monitor_width</span> <span class="o">=</span> <span class="mi">1680</span>
<span class="n">monitor_height</span> <span class="o">=</span> <span class="mi">1050</span>

<div class="viewcode-block" id="fig_one"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.fig_one">[docs]</a><span class="k">def</span> <span class="nf">fig_one</span><span class="p">():</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>    
    
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">x_dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_dist</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        
        <span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)</span>
        <span class="n">corr_x</span> <span class="o">=</span> <span class="n">sub_df</span><span class="o">.</span><span class="n">corr_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">corr_y</span> <span class="o">=</span> <span class="n">sub_df</span><span class="o">.</span><span class="n">corr_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
        
        <span class="n">x_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x</span><span class="p">)</span>
        <span class="n">y_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y</span><span class="p">)</span>
    
    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;model_outputs.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">params</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">x_dist_1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_dist_3</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_dist_13</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">y_dist_1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_dist_3</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_dist_13</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        
        <span class="n">corr_x_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">corr_x_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train3_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">corr_x_13</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train13_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">corr_y_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">corr_y_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train3_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">corr_y_13</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train13_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>     
        
        <span class="n">x_dist_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x_1</span><span class="p">)</span>
        <span class="n">x_dist_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x_3</span><span class="p">)</span>
        <span class="n">x_dist_13</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x_13</span><span class="p">)</span>
        
        <span class="n">y_dist_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y_1</span><span class="p">)</span>
        <span class="n">y_dist_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y_3</span><span class="p">)</span>
        <span class="n">y_dist_13</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y_13</span><span class="p">)</span>
    
    <span class="c1">###############################################################</span>
    
    <span class="n">x_dist_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_dist_1</span> <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="n">x_dist_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_dist_3</span> <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="n">x_dist_13</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_dist_13</span> <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    
    <span class="n">y_dist_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_dist_1</span> <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="n">y_dist_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_dist_3</span> <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="n">y_dist_13</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_dist_13</span> <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PEER1 Accuracy&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_dist</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_dist</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;x-direction&#39;</span><span class="p">,</span> <span class="s1">&#39;y-direction&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig1a.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Accuracy by Model (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_dist_1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_dist_3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_dist_13</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;PEER1&#39;</span><span class="p">,</span> <span class="s1">&#39;PEER3&#39;</span><span class="p">,</span> <span class="s1">&#39;PEER1&amp;3&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>   
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig1b.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Accuracy by Model (Y-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_dist_1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_dist_3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_dist_13</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;PEER1&#39;</span><span class="p">,</span> <span class="s1">&#39;PEER3&#39;</span><span class="p">,</span> <span class="s1">&#39;PEER1&amp;3&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig1c.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    
    
<div class="viewcode-block" id="training_optimization_paired_ttest"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.training_optimization_paired_ttest">[docs]</a><span class="k">def</span> <span class="nf">training_optimization_paired_ttest</span><span class="p">():</span>  
    
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">x_dist_1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_dist_3</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_dist_13</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_dist_1gsr</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">y_dist_1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_dist_3</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_dist_13</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_dist_1gsr</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        
        <span class="n">x_dist_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">x_dist_1gsr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_dist_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_dist_1gsr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x_dist_13</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train13_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">y_dist_13</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train13_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">x_dist_13</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">y_dist_13</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x_dist_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train3_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">y_dist_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train3_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">x_dist_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">y_dist_3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        
    <span class="n">df_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x_1&#39;</span><span class="p">:</span> <span class="n">x_dist_1</span><span class="p">,</span> <span class="s1">&#39;x_3&#39;</span><span class="p">:</span> <span class="n">x_dist_3</span><span class="p">,</span> <span class="s1">&#39;x_13&#39;</span><span class="p">:</span> <span class="n">x_dist_13</span><span class="p">,</span> <span class="s1">&#39;x_1gsr&#39;</span><span class="p">:</span> <span class="n">x_dist_1gsr</span><span class="p">,</span>
               <span class="s1">&#39;y_1&#39;</span><span class="p">:</span> <span class="n">y_dist_1</span><span class="p">,</span> <span class="s1">&#39;y_3&#39;</span><span class="p">:</span> <span class="n">y_dist_3</span><span class="p">,</span> <span class="s1">&#39;y_13&#39;</span><span class="p">:</span> <span class="n">y_dist_13</span><span class="p">,</span> <span class="s1">&#39;y_1gsr&#39;</span><span class="p">:</span> <span class="n">y_dist_1gsr</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">df_dict</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">group1</span><span class="p">,</span> <span class="n">group2</span> <span class="ow">in</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;13&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;13&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]]:</span>
        
        <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;x_&#39;</span>
        
        <span class="n">group1</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">+</span> <span class="n">group1</span>
        <span class="n">group2</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">+</span> <span class="n">group2</span>
        
        <span class="n">df_subset</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="n">group1</span> <span class="p">,</span><span class="n">group2</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">t_stat</span><span class="p">,</span> <span class="n">p_val</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df_subset</span><span class="p">[</span><span class="n">group1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">df_subset</span><span class="p">[</span><span class="n">group2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">t_stat</span><span class="p">,</span> <span class="n">p_val</span><span class="p">)</span></div>



<div class="viewcode-block" id="paired_ttest_cal_scan"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.paired_ttest_cal_scan">[docs]</a><span class="k">def</span> <span class="nf">paired_ttest_cal_scan</span><span class="p">():</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span>
    
    <span class="n">df_fd</span> <span class="o">=</span>  <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Scan1_meanfd&#39;</span><span class="p">,</span> <span class="s1">&#39;Scan3_meanfd&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_fd</span><span class="o">.</span><span class="n">Scan1_meanfd</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_fd</span><span class="o">.</span><span class="n">Scan3_meanfd</span><span class="p">)))</span>
    <span class="n">df_dvars</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Scan1_dvars&#39;</span><span class="p">,</span> <span class="s1">&#39;Scan3_dvars&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_dvars</span><span class="o">.</span><span class="n">Scan1_dvars</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dvars</span><span class="o">.</span><span class="n">Scan3_dvars</span><span class="p">)))</span></div>


<div class="viewcode-block" id="fig_two"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.fig_two">[docs]</a><span class="k">def</span> <span class="nf">fig_two</span><span class="p">():</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
    
    <span class="c1">###########</span>
    <span class="c1"># Mean FD</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">)</span>

    <span class="n">viewtype</span> <span class="o">=</span> <span class="s1">&#39;calibration&#39;</span>
    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;peer&#39;</span>
    <span class="n">cscheme</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span>
    <span class="n">sorted_by</span> <span class="o">=</span> <span class="s1">&#39;Scan1_meanfd&#39;</span>

    <span class="n">x_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_stack</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sorted_by</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">filename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_calibration_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
                     <span class="s1">&#39;tp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
                     <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}}</span>

    <span class="n">fixations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stim_vals.csv&#39;</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_x&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_y&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]))</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_targets</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_targets</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>
        
    <span class="n">x_hm</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_hm</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>

                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error processing subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>            
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_targets</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_targets</span><span class="p">)</span>

    <span class="n">x_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_stack</span><span class="p">)</span>

    <span class="n">x_spacing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_hm</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predicted Time Series for</span><span class="se">\n</span><span class="s1">Calibration (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">x_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Subjects Ordered by Framewise Displacement&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/cbar_x.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1">############</span>
    <span class="c1"># Age</span>
    
    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">)</span>

    <span class="n">viewtype</span> <span class="o">=</span> <span class="s1">&#39;calibration&#39;</span>
    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;peer&#39;</span>
    <span class="n">cscheme</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span>
    <span class="n">sorted_by</span> <span class="o">=</span> <span class="s1">&#39;age&#39;</span>

    <span class="n">x_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_stack</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sorted_by</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">filename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_calibration_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
                     <span class="s1">&#39;tp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
                     <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}}</span>

    <span class="n">fixations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stim_vals.csv&#39;</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_x&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_y&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]))</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_targets</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_targets</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>
        
    <span class="n">x_hm</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_hm</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>

                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error processing subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>            
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_targets</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_targets</span><span class="p">)</span>

    <span class="n">x_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_stack</span><span class="p">)</span>

    <span class="n">x_spacing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_hm</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predicted Time Series for</span><span class="se">\n</span><span class="s1">Calibration (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">x_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Subjects Ordered by Age&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig2b.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    
    <span class="c1">##### Linear Regression</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span>
    
    <span class="n">lowess</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span>

    <span class="n">fd_effects</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr_x</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">Scan1_meanfd</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">legend_properties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Impact of Mean FD on Accuracy (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Scan1_meanfd&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;corr_x&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Mean Framewise Displacement&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fd_effects</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">fd_effects</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lowess Smoothing&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="n">legend_properties</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig2c.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">age_effects</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr_x</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">legend_properties</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Impact of Age on Accuracy (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;corr_x&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">age_effects</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">age_effects</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lowess Smoothing&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">25</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">4.9</span><span class="p">,</span> <span class="mf">21.1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="n">legend_properties</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig2d.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    
    <span class="c1">############################################</span>
    <span class="c1"># Panel C</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">x_norm</span> <span class="o">=</span> <span class="p">[]</span>    
    <span class="n">x_gs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">y_norm</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_gs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        
        <span class="n">x_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">x_gs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_gs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    
    <span class="n">df_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x_norm&#39;</span><span class="p">:</span> <span class="n">x_norm</span><span class="p">,</span> <span class="s1">&#39;x_gs&#39;</span><span class="p">:</span> <span class="n">x_gs</span><span class="p">,</span> <span class="s1">&#39;y_norm&#39;</span><span class="p">:</span> <span class="n">y_norm</span><span class="p">,</span> <span class="s1">&#39;y_gs&#39;</span><span class="p">:</span> <span class="n">y_gs</span><span class="p">}</span>    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">df_dict</span><span class="p">)</span>
    
    <span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x_norm</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">x_gs</span><span class="p">)</span>
    <span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">y_gs</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
    
    <span class="n">vc_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/all_censored_corr.csv&#39;</span><span class="p">)</span>
    
    <span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">vc_df</span><span class="o">.</span><span class="n">x_raw</span><span class="p">,</span> <span class="n">vc_df</span><span class="o">.</span><span class="n">x_censor</span><span class="p">)</span>
    <span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">vc_df</span><span class="o">.</span><span class="n">y_raw</span><span class="p">,</span> <span class="n">vc_df</span><span class="o">.</span><span class="n">y_censor</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span></div>



    


<div class="viewcode-block" id="phenotype_motion"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.phenotype_motion">[docs]</a><span class="k">def</span> <span class="nf">phenotype_motion</span><span class="p">():</span>
    
    <span class="c1"># Uses correlation values from PEER1</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span>
    
    <span class="c1"># In x-direction</span>

    <span class="n">meanfd</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_x ~ Scan1_meanfd&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">meanfd</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">dvars</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_x ~ Scan1_dvars&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dvars</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_x ~ age&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">age</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">fsiq</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_x ~ fsiq&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fsiq</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">age_meanfd</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_x ~ Scan1_meanfd + age&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">age_meanfd</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    
    <span class="c1"># In y-direction</span>
    
    <span class="n">meanfd</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_y ~ Scan1_meanfd&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">meanfd</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">dvars</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_y ~ Scan1_dvars&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dvars</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_y ~ age&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">age</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">fsiq</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_y ~ fsiq&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fsiq</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    <span class="n">age_meanfd</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;corr_y ~ Scan1_meanfd + age&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">age_meanfd</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
    
    <span class="c1"># Visual inspection for potential outliers (e.g. low motion, low model accuracy)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Scan1_meanfd&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;corr_x&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># Identification of outliers via thresholding for model accuracy and mean_fd</span>
    
    <span class="n">outlier_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">corr_x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Scan1_meanfd</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mi">2</span><span class="p">)][[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Scan1_meanfd&#39;</span><span class="p">,</span> <span class="s1">&#39;Scan2_meanfd&#39;</span><span class="p">]]</span></div>


<div class="viewcode-block" id="fig_three"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.fig_three">[docs]</a><span class="k">def</span> <span class="nf">fig_three</span><span class="p">():</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
    
    <span class="c1">###########</span>
    <span class="c1"># TP Heatmap</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">)</span>

    <span class="n">viewtype</span> <span class="o">=</span> <span class="s1">&#39;tp&#39;</span>
    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;peer&#39;</span>
    <span class="n">cscheme</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span>
    <span class="n">sorted_by</span> <span class="o">=</span> <span class="s1">&#39;Scan1_meanfd&#39;</span>

    <span class="n">x_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_stack</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sorted_by</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">filename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_calibration_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
                     <span class="s1">&#39;tp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
                     <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}}</span>

    <span class="n">fixations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stim_vals.csv&#39;</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_x&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_y&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]))</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>

                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error processing subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>
            
    <span class="n">avg_series_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arrx</span><span class="p">)</span>        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">avg_series_x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>  
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_series_x</span><span class="p">)</span>
        
    <span class="n">avg_series_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arry</span><span class="p">)</span>        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">avg_series_y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_series_y</span><span class="p">)</span>

    <span class="n">x_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_stack</span><span class="p">)</span>
    <span class="n">y_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">y_stack</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predicted Time Series for</span><span class="se">\n</span><span class="s1">The Present (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">x_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Subjects&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig3a.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predicted Time Series for</span><span class="se">\n</span><span class="s1">The Present (Y-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">y_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Subjects&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/cbar_y.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1">###########</span>
    <span class="c1"># DM Heatmap</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">)</span>

    <span class="n">viewtype</span> <span class="o">=</span> <span class="s1">&#39;dm&#39;</span>
    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;peer&#39;</span>
    <span class="n">cscheme</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span>
    <span class="n">sorted_by</span> <span class="o">=</span> <span class="s1">&#39;Scan1_meanfd&#39;</span>

    <span class="n">x_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_stack</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sorted_by</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">filename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_calibration_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
                     <span class="s1">&#39;tp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
                     <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}}</span>

    <span class="n">fixations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stim_vals.csv&#39;</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_x&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_y&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]))</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>

                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error processing subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>
            
    <span class="n">avg_series_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arrx</span><span class="p">)</span>        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">avg_series_x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>  
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_series_x</span><span class="p">)</span>
        
    <span class="n">avg_series_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">arry</span><span class="p">)</span>        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">avg_series_y</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>  
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_series_y</span><span class="p">)</span>

    <span class="n">x_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_stack</span><span class="p">)</span>
    <span class="n">y_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">y_stack</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predicted Time Series for</span><span class="se">\n</span><span class="s1">Despicable Me (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">x_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Subjects&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig3c.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predicted Time Series for</span><span class="se">\n</span><span class="s1">Despicable Me (Y-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">y_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Subjects&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig3d.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1">###########</span>
    <span class="c1"># Movie correlations</span>
    
    <span class="n">sub_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/qap_naturalistic_mri.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
    
    <span class="n">expected_value</span> <span class="o">=</span> <span class="mi">250</span>

    <span class="n">pd_dict_x</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">pd_dict_y</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">corr_matrix_tp_x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_matrix_tp_y</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">tp_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">tp_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tp_x</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_value</span><span class="p">:</span>
                <span class="n">corr_matrix_tp_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp_x</span><span class="p">)</span>
                <span class="n">corr_matrix_tp_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp_y</span><span class="p">)</span>
    
                <span class="n">pd_dict_x</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;tp&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tp_x</span>
                <span class="n">pd_dict_y</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;tp&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tp_y</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="k">continue</span>

    <span class="n">corr_matrix_dm_x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_matrix_dm_y</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>
    
            <span class="n">dm_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">][:</span><span class="mi">250</span><span class="p">])</span>
            <span class="n">dm_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">][:</span><span class="mi">250</span><span class="p">])</span>
    
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dm_x</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_value</span><span class="p">:</span>
                <span class="n">corr_matrix_dm_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dm_x</span><span class="p">)</span>
                <span class="n">corr_matrix_dm_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dm_y</span><span class="p">)</span>
    
                <span class="n">pd_dict_x</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dm_x</span>
                <span class="n">pd_dict_y</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dm_y</span>
    
        <span class="k">except</span><span class="p">:</span>
    
            <span class="k">continue</span>

    <span class="n">pd_dict_x</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd_dict_x</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]))</span>
    <span class="n">pd_dict_y</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd_dict_y</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]))</span>

    <span class="n">df_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">pd_dict_x</span><span class="p">)</span>
    <span class="n">df_x</span> <span class="o">=</span> <span class="n">df_x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="n">df_x</span> <span class="o">=</span> <span class="n">df_x</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df_x</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">pd_dict_y</span><span class="p">)</span>
    <span class="n">df_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="n">df_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df_y</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">corr_x</span> <span class="o">=</span> <span class="n">df_x</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span>
    <span class="n">corr_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span>

    <span class="c1"># OPTIONAL - INCLUDE ONLY BELOW DIAGNOAL</span>
    <span class="n">mask_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr_x</span><span class="p">)</span>
    <span class="n">mask_x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask_x</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">mask_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr_y</span><span class="p">)</span>
    <span class="n">mask_y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask_y</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">within_x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">between_x</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item1</span> <span class="ow">in</span> <span class="n">corr_x</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item2</span> <span class="ow">in</span> <span class="n">corr_x</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">within_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">between_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Completed x matrix&#39;</span><span class="p">)</span>

    <span class="n">final_dict_x</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">final_dict_x</span><span class="p">[</span><span class="s2">&quot; &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">within_x</span> <span class="o">+</span> <span class="n">between_x</span>
    <span class="n">final_dict_x</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Same Subject</span><span class="se">\n</span><span class="s1">Different Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">within_x</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Different Subject</span><span class="se">\n</span><span class="s1">Different Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">between_x</span><span class="p">)</span>

    <span class="n">final_df_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">final_dict_x</span><span class="p">)</span>
    
    <span class="n">within_y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">between_y</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item1</span> <span class="ow">in</span> <span class="n">corr_y</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item2</span> <span class="ow">in</span> <span class="n">corr_y</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">within_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">between_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Completed y matrix&#39;</span><span class="p">)</span>

    <span class="n">final_dict_y</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">final_dict_y</span><span class="p">[</span><span class="s2">&quot; &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">within_y</span> <span class="o">+</span> <span class="n">between_y</span>
    <span class="n">final_dict_y</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Same Subject</span><span class="se">\n</span><span class="s1">Different Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">within_y</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Different Subject</span><span class="se">\n</span><span class="s1">Different Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">between_y</span><span class="p">)</span>

    <span class="n">final_df_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">final_dict_y</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_df_x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Movie Discriminability (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Different Participant</span><span class="se">\n</span><span class="s1">Same Movie&#39;</span><span class="p">,</span> <span class="s1">&#39;Different Participant</span><span class="se">\n</span><span class="s1">Different Movie&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig3e.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_df_y</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Movie Discriminability (Y-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Different Participant</span><span class="se">\n</span><span class="s1">Same Movie&#39;</span><span class="p">,</span> <span class="s1">&#39;Different Participant</span><span class="se">\n</span><span class="s1">Different Movie&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig3f.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>



<div class="viewcode-block" id="fig_four"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.fig_four">[docs]</a><span class="k">def</span> <span class="nf">fig_four</span><span class="p">():</span>

    <span class="n">viewtype</span> <span class="o">=</span> <span class="s1">&#39;tp&#39;</span>
    <span class="n">cscheme</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">min_scan</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns list of subjects with at least the specified number of calibration scans</span>

<span class="sd">        :param min_scan: Minimum number of scans required to be included in subject list</span>
<span class="sd">        :return: Dataframe containing subject IDs, site of MRI collection, number of calibration scans, and motion measures</span>
<span class="sd">        :return: List containing subjects with at least min_scan calibration scans</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;model_outputs.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">convert_objects</span><span class="p">(</span><span class="n">convert_numeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">min_scan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[(</span><span class="n">params</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)]</span>

        <span class="k">elif</span> <span class="n">min_scan</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">params</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>

        <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">params</span><span class="p">,</span> <span class="n">sub_list</span>


    <span class="n">params</span><span class="p">,</span> <span class="n">sub_list</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">min_scan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">x_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sorted_by</span> <span class="o">=</span> <span class="s1">&#39;mean_fd&#39;</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sorted_by</span><span class="p">])</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_sub_list_with_et_and_peer</span><span class="p">(</span><span class="n">full_list</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Creates a list of subjects with both ET and PEER predictions</span>

<span class="sd">        :param full_list: List of subject IDs containing all subjects with at least 2/3 valid calibration scans</span>
<span class="sd">        :return: Subject list with both ET and PEER predictions</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">et_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">full_list</span><span class="p">:</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">))</span> <span class="ow">and</span> \
                    <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span>
                        <span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">)):</span>
                <span class="n">et_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">et_list</span>

    <span class="n">et_list</span> <span class="o">=</span> <span class="n">create_sub_list_with_et_and_peer</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Lei/Peers/scripts/data_check/TP_bad_sub.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">bad_subs_list_tp</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Lei/Peers/scripts/data_check/DM_bad_sub.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">bad_subs_list_dm</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">bad_subs_list_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bad_subs_list_tp</span><span class="p">]</span>
    <span class="n">bad_subs_list_dm</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bad_subs_list_dm</span><span class="p">]</span>

    <span class="n">et_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">et_list</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_subs_list_tp</span><span class="p">]</span>
    <span class="n">et_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">et_list</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_subs_list_dm</span><span class="p">]</span>


    <span class="n">filename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_calibration_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
                     <span class="s1">&#39;tp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
                     <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}}</span>

    <span class="n">fixations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stim_vals.csv&#39;</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_x&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_y&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;peer&#39;</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span>
                    <span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>
                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error processing subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>

    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">))</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">viewtype</span> <span class="o">==</span> <span class="s1">&#39;calibration&#39;</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">et_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">02</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
            <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
            <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">et_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">02</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
            <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_targets</span><span class="p">)</span>
            <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_targets</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">avg_series_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">avg_series_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">et_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
            <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
            <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>

        <span class="c1"># for num in range(int(np.round(len(et_list) * .02, 0))):</span>
        <span class="c1">#     x_stack.append(avg_series_x)</span>
        <span class="c1">#     y_stack.append(avg_series_y)</span>

    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;et&#39;</span>

    <span class="n">retain_et_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">count_include</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_exclude</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>
                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_count</span> <span class="o">=</span> <span class="n">x_series</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="o">-</span><span class="mi">840</span><span class="p">)</span>
                <span class="n">y_count</span> <span class="o">=</span> <span class="n">y_series</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mf">525.0</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">x_count</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y_count</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="p">):</span>

                    <span class="n">count_include</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="nb">print</span><span class="p">(</span><span class="n">sub</span><span class="p">,</span> <span class="n">count_include</span><span class="p">)</span>
                    <span class="n">retain_et_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>

                    <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                    <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">count_exclude</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Subject &#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39; excluded from analysis&#39;</span><span class="p">,</span> <span class="n">count_exclude</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="k">continue</span>

    <span class="n">x_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_stack</span><span class="p">)</span>
    <span class="n">y_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">y_stack</span><span class="p">)</span>

    <span class="n">x_spacing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_hm</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fixation Time Series for The Present (X-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">x_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">505</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;PEER&#39;</span><span class="p">,</span> <span class="s1">&#39;Eye    </span><span class="se">\n</span><span class="s1">Tracking&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig4a.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fixation Time Series for The Present (Y-Direction)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">y_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">200</span><span class="p">,</span> <span class="mi">505</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;PEER&#39;</span><span class="p">,</span> <span class="s1">&#39;Eye    </span><span class="se">\n</span><span class="s1">Tracking&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (Volumes)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig4b.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>




<div class="viewcode-block" id="sup_fig_one"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.sup_fig_one">[docs]</a><span class="k">def</span> <span class="nf">sup_fig_one</span><span class="p">():</span>
    
    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">x_dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_dist</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        
        <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)</span>
        
        <span class="n">x_rmse</span> <span class="o">=</span> <span class="n">temp_df</span><span class="o">.</span><span class="n">rmse_x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_rmse</span> <span class="o">=</span> <span class="n">temp_df</span><span class="o">.</span><span class="n">rmse_y</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">x_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_rmse</span><span class="p">)</span>
        <span class="n">y_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_rmse</span><span class="p">)</span>
        
    
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PEER1 Accuracy using RMSE&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_dist</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_dist</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">850</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;X-Direction&#39;</span><span class="p">,</span> <span class="s1">&#39;Y-Direction&#39;</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/sup1.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    


<div class="viewcode-block" id="sup_fig_two"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.sup_fig_two">[docs]</a><span class="k">def</span> <span class="nf">sup_fig_two</span><span class="p">():</span>
    
    <span class="n">fixations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stim_vals.csv&#39;</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_x&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">y_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_y&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x_targets</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">y_targets</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Calibration Stimulus&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Horizontal Distance from Center (px)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Vertical Distance from Center (px)&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">840</span><span class="p">,</span> <span class="mi">840</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">525</span><span class="p">,</span> <span class="mi">525</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/sup2.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>



































<span class="k">def</span> <span class="nf">fig_three_old</span><span class="p">():</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">x_norm</span> <span class="o">=</span> <span class="p">[]</span>    
    <span class="n">x_gs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">y_norm</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_gs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        
        <span class="n">x_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">x_gs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_gs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    
    <span class="n">df_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x_norm&#39;</span><span class="p">:</span> <span class="n">x_norm</span><span class="p">,</span> <span class="s1">&#39;x_gs&#39;</span><span class="p">:</span> <span class="n">x_gs</span><span class="p">,</span> <span class="s1">&#39;y_norm&#39;</span><span class="p">:</span> <span class="n">y_norm</span><span class="p">,</span> <span class="s1">&#39;y_gs&#39;</span><span class="p">:</span> <span class="n">y_gs</span><span class="p">}</span>    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">df_dict</span><span class="p">)</span>
    
    <span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x_norm</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">x_gs</span><span class="p">)</span>
    <span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">y_gs</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>
    
    <span class="n">vc_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/all_censored_corr.csv&#39;</span><span class="p">)</span>
    
    <span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">vc_df</span><span class="o">.</span><span class="n">x_raw</span><span class="p">,</span> <span class="n">vc_df</span><span class="o">.</span><span class="n">x_censor</span><span class="p">)</span>
    <span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">vc_df</span><span class="o">.</span><span class="n">y_raw</span><span class="p">,</span> <span class="n">vc_df</span><span class="o">.</span><span class="n">y_censor</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Impact of Preprocessing on Model Accuracy&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;x-direction (All Subjects)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x_norm</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x_gs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vc_df</span><span class="o">.</span><span class="n">x_censor</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;GSR&#39;</span><span class="p">,</span> <span class="s1">&#39;VC&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;y-direction (All Subjects)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">y_norm</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">y_gs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vc_df</span><span class="o">.</span><span class="n">y_censor</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;GSR&#39;</span><span class="p">,</span> <span class="s1">&#39;VC&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="c1">#plt.savefig(&#39;/home/json/Desktop/manuscript_figures/fig3.png&#39;, dpi=600)</span>
    
    <span class="c1">#########</span>
    <span class="c1"># Remove subjects with mean FD &lt; .2</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Scan1_meanfd</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">x_norm</span> <span class="o">=</span> <span class="p">[]</span>    
    <span class="n">x_gs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="n">y_norm</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_gs</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>
        
        <span class="n">x_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_norm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">x_gs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_gs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr1_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    
    <span class="n">df_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x_norm&#39;</span><span class="p">:</span> <span class="n">x_norm</span><span class="p">,</span> <span class="s1">&#39;x_gs&#39;</span><span class="p">:</span> <span class="n">x_gs</span><span class="p">,</span> <span class="s1">&#39;y_norm&#39;</span><span class="p">:</span> <span class="n">y_norm</span><span class="p">,</span> <span class="s1">&#39;y_gs&#39;</span><span class="p">:</span> <span class="n">y_gs</span><span class="p">}</span>    
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">df_dict</span><span class="p">)</span>
    
    <span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x_norm</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">x_gs</span><span class="p">)</span>
    <span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">y_norm</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">y_gs</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">x_p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y_t</span><span class="p">,</span> <span class="n">y_p</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;x-direction (Subjects with Mean FD &gt; .2)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x_norm</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x_gs</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;GSR&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;y-direction (Subjects with Mean FD &gt; .2)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">y_norm</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">y_gs</span><span class="p">)])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Original&#39;</span><span class="p">,</span> <span class="s1">&#39;GSR&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig3.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

 
<div class="viewcode-block" id="fig_three_old"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.fig_three_old">[docs]</a><span class="k">def</span> <span class="nf">fig_three_old</span><span class="p">():</span>

    <span class="n">sub_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/qap_naturalistic_mri.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
    
    <span class="n">expected_value</span> <span class="o">=</span> <span class="mi">250</span>

    <span class="n">pd_dict_x</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">pd_dict_y</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">corr_matrix_tp_x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_matrix_tp_y</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">tp_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">tp_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tp_x</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_value</span><span class="p">:</span>
                <span class="n">corr_matrix_tp_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp_x</span><span class="p">)</span>
                <span class="n">corr_matrix_tp_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp_y</span><span class="p">)</span>
    
                <span class="n">pd_dict_x</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;tp&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tp_x</span>
                <span class="n">pd_dict_y</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;tp&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">tp_y</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="k">continue</span>

    <span class="n">corr_matrix_dm_x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_matrix_dm_y</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>
    
            <span class="n">dm_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">][:</span><span class="mi">250</span><span class="p">])</span>
            <span class="n">dm_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">][:</span><span class="mi">250</span><span class="p">])</span>
    
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dm_x</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_value</span><span class="p">:</span>
                <span class="n">corr_matrix_dm_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dm_x</span><span class="p">)</span>
                <span class="n">corr_matrix_dm_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dm_y</span><span class="p">)</span>
    
                <span class="n">pd_dict_x</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dm_x</span>
                <span class="n">pd_dict_y</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]</span> <span class="o">=</span> <span class="n">dm_y</span>
    
        <span class="k">except</span><span class="p">:</span>
    
            <span class="k">continue</span>

    <span class="n">pd_dict_x</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd_dict_x</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]))</span>
    <span class="n">pd_dict_y</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pd_dict_y</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;dm&#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)]))</span>

    <span class="n">df_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">pd_dict_x</span><span class="p">)</span>
    <span class="n">df_x</span> <span class="o">=</span> <span class="n">df_x</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="n">df_x</span> <span class="o">=</span> <span class="n">df_x</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df_x</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">pd_dict_y</span><span class="p">)</span>
    <span class="n">df_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
    <span class="n">df_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">reindex_axis</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df_y</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">corr_x</span> <span class="o">=</span> <span class="n">df_x</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span>
    <span class="n">corr_y</span> <span class="o">=</span> <span class="n">df_y</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span>

    <span class="c1"># OPTIONAL - INCLUDE ONLY BELOW DIAGNOAL</span>
    <span class="n">mask_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr_x</span><span class="p">)</span>
    <span class="n">mask_x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask_x</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">mask_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr_y</span><span class="p">)</span>
    <span class="n">mask_y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask_y</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">within_x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">between_x</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item1</span> <span class="ow">in</span> <span class="n">corr_x</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item2</span> <span class="ow">in</span> <span class="n">corr_x</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">within_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">between_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Completed x matrix&#39;</span><span class="p">)</span>

    <span class="n">final_dict_x</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">final_dict_x</span><span class="p">[</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">within_x</span> <span class="o">+</span> <span class="n">between_x</span>
    <span class="n">final_dict_x</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Within Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">within_x</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Between Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">between_x</span><span class="p">)</span>

    <span class="n">final_df_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">final_dict_x</span><span class="p">)</span>

    <span class="n">within_y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">between_y</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item1</span> <span class="ow">in</span> <span class="n">corr_y</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item2</span> <span class="ow">in</span> <span class="n">corr_y</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">within_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">item1</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">item1</span> <span class="o">!=</span> <span class="n">item2</span><span class="p">):</span>
                <span class="n">between_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y</span><span class="p">[</span><span class="n">item1</span><span class="p">][</span><span class="n">item2</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Completed y matrix&#39;</span><span class="p">)</span>

    <span class="n">final_dict_y</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">final_dict_y</span><span class="p">[</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">within_y</span> <span class="o">+</span> <span class="n">between_y</span>
    <span class="n">final_dict_y</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Within Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">within_y</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Between Movie&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">between_y</span><span class="p">)</span>

    <span class="n">final_df_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">final_dict_y</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Movie Discriminability&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation Matrices for DM and TP&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_x</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">213</span><span class="p">,</span> <span class="mi">607</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;DM&#39;</span><span class="p">,</span> <span class="s1">&#39;TP&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">213</span><span class="p">,</span> <span class="mi">607</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;DM&#39;</span><span class="p">,</span> <span class="s1">&#39;TP&#39;</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">213</span><span class="p">,</span> <span class="mi">607</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;DM&#39;</span><span class="p">,</span> <span class="s1">&#39;TP&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">213</span><span class="p">,</span> <span class="mi">607</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;DM&#39;</span><span class="p">,</span> <span class="s1">&#39;TP&#39;</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Within and Between Movie Correlations&#39;</span><span class="p">)</span>
    <span class="c1"># ax = sns.boxplot(x=&#39;&#39;, y=&quot;Pearson&#39;s r&quot;, data=final_df_x)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_df_x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1"># ax = sns.stripplot(x=&#39;&#39;, y=&quot;Pearson&#39;s r&quot;, data=final_df_x, jitter=True)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">final_df_y</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/fig3.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    
    
    
    






    
    
    
    
    
<div class="viewcode-block" id="sup_fig_X"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.sup_fig_X">[docs]</a><span class="k">def</span> <span class="nf">sup_fig_X</span><span class="p">():</span>

    <span class="c1"># To compare linear relationship between Pearson&#39;s r and factors that may affect head motion</span>

    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">min_scan</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Returns list of subjects with at least the specified number of calibration scans</span>

<span class="sd">        :param min_scan: Minimum number of scans required to be included in subject list</span>
<span class="sd">        :return: Dataframe containing subject IDs, site of MRI collection, number of calibration scans, and motion measures</span>
<span class="sd">        :return: List containing subjects with at least min_scan calibration scans</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;model_outputs.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">convert_objects</span><span class="p">(</span><span class="n">convert_numeric</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">min_scan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[(</span><span class="n">params</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)]</span>

        <span class="k">elif</span> <span class="n">min_scan</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">params</span><span class="o">.</span><span class="n">scan_count</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>

        <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">params</span><span class="p">,</span> <span class="n">sub_list</span>

    <span class="n">params</span><span class="p">,</span> <span class="n">sub_list</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">min_scan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">motion_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;mean_fd&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;dvars&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;corr_x&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;corr_y&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;fsiq&#39;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/Peer_pheno.csv&#39;</span><span class="p">)</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">temp_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="n">mean_fd</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sub</span><span class="p">,</span> <span class="s1">&#39;mean_fd&#39;</span><span class="p">]</span>
            <span class="n">dvars</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sub</span><span class="p">,</span> <span class="s1">&#39;dvars&#39;</span><span class="p">]</span>
            <span class="n">corr_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">resample_path</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;//gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">corr_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">resample_path</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;//gsr0_train1_model_parameters.csv&#39;</span><span class="p">)[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">age_val</span> <span class="o">=</span> <span class="n">temp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;sub-&#39;</span><span class="p">)),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span>
            <span class="n">fsiq_val</span> <span class="o">=</span> <span class="n">temp_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;sub-&#39;</span><span class="p">)),</span> <span class="s1">&#39;FSIQ&#39;</span><span class="p">]</span>

            <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;mean_fd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_fd</span><span class="p">)</span>
            <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;dvars&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvars</span><span class="p">)</span>
            <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_x</span><span class="p">)</span>
            <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr_y</span><span class="p">)</span>
            <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">age_val</span><span class="p">)</span>
            <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;fsiq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fsiq_val</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="k">continue</span>

    <span class="n">mean_fd_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dvars_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_x_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_y_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">age_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fsiq_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">motion_type</span> <span class="o">=</span> <span class="s1">&#39;mean_fd&#39;</span>
    <span class="n">thresh</span> <span class="o">=</span> <span class="mi">100000</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">])):</span>

        <span class="k">if</span> <span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">][</span><span class="n">num</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">thresh</span><span class="p">:</span>

            <span class="n">mean_fd_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;mean_fd&#39;</span><span class="p">][</span><span class="n">num</span><span class="p">])</span>
            <span class="n">dvars_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;dvars&#39;</span><span class="p">][</span><span class="n">num</span><span class="p">])</span>
            <span class="n">corr_x_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="n">num</span><span class="p">])</span>
            <span class="n">corr_y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="n">num</span><span class="p">])</span>
            <span class="n">age_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">][</span><span class="n">num</span><span class="p">])</span>
            <span class="n">fsiq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;fsiq&#39;</span><span class="p">][</span><span class="n">num</span><span class="p">])</span>

    <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;mean_fd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_fd_list</span>
    <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;dvars&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dvars_list</span>
    <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr_x_list</span>
    <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">corr_y_list</span>
    <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_list</span>
    <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;fsiq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsiq_list</span>

    <span class="c1">######## MeanFD and DVARS</span>

    <span class="n">motion_type</span> <span class="o">=</span> <span class="s1">&#39;mean_fd&#39;</span>

    <span class="n">val_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]))</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">])</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MeanFD Effects on Model Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MeanFD&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">])</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MeanFD&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

    <span class="c1">########</span>

    <span class="n">motion_type</span> <span class="o">=</span> <span class="s1">&#39;dvars&#39;</span>

    <span class="n">val_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]))</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">])</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;DVARS Effects on Model Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;DVARS&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">])</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;DVARS&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer_figures_final/motion_effects.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1">######## Age and FSIQ</span>

    <span class="n">motion_type</span> <span class="o">=</span> <span class="s1">&#39;age&#39;</span>

    <span class="n">val_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]))</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">])</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Age Effects on Model Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">])</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

    <span class="c1">########</span>

    <span class="n">motion_type</span> <span class="o">=</span> <span class="s1">&#39;fsiq&#39;</span>

    <span class="n">fsiq_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_x_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">corr_y_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;fsiq&#39;</span><span class="p">])):</span>

        <span class="k">if</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;fsiq&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">]):</span>
            <span class="n">fsiq_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;fsiq&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">])</span>
            <span class="n">corr_x_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">])</span>
            <span class="n">corr_y_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">][</span><span class="n">item</span><span class="p">])</span>

    <span class="n">val_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]),</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">]))</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fsiq_list</span><span class="p">,</span> <span class="n">corr_x_list</span><span class="p">)</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FSIQ Effects on Model Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_x&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

    <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_val</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">std_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span><span class="n">fsiq_list</span><span class="p">,</span> <span class="n">corr_y_list</span><span class="p">)</span>
    <span class="n">r2_val</span> <span class="o">=</span> <span class="n">r_val</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">r2_text</span> <span class="o">=</span> <span class="s1">&#39;r2 value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r2_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">r_text</span> <span class="o">=</span> <span class="s1">&#39;r value: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">r_val</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;FSIQ&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Pearson&#39;s r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-.</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">motion_dict</span><span class="p">[</span><span class="n">motion_type</span><span class="p">],</span> <span class="n">motion_dict</span><span class="p">[</span><span class="s1">&#39;corr_y&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">val_range</span><span class="p">,</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">val_range</span><span class="p">)</span> <span class="o">+</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">r_text</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer_figures_final/age_fsiq_effects.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
    
    
    
    
    
    
    
    


    
    
    

<div class="viewcode-block" id="eeg_peer_comparison"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.eeg_peer_comparison">[docs]</a><span class="k">def</span> <span class="nf">eeg_peer_comparison</span><span class="p">():</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/fingerprinting_qap.csv&#39;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">PEER1</span> <span class="o">&lt;=</span> <span class="o">.</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">TP</span> <span class="o">&lt;=.</span><span class="mi">2</span><span class="p">)]</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_sub_list_with_et_and_peer</span><span class="p">(</span><span class="n">full_list</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Creates a list of subjects with both ET and PEER predictions</span>

<span class="sd">        :param full_list: List of subject IDs containing all subjects with at least 2/3 valid calibration scans</span>
<span class="sd">        :return: Subject list with both ET and PEER predictions</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">et_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">full_list</span><span class="p">:</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">))</span> <span class="ow">and</span> \
                    <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span>
                        <span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">)):</span>
                <span class="n">et_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">et_list</span>

    <span class="n">et_list</span> <span class="o">=</span> <span class="n">create_sub_list_with_et_and_peer</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Lei/Peers/scripts/data_check/TP_bad_sub.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">bad_subs_list_tp</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Lei/Peers/scripts/data_check/DM_bad_sub.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">bad_subs_list_dm</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">bad_subs_list_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bad_subs_list_tp</span><span class="p">]</span>
    <span class="n">bad_subs_list_dm</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bad_subs_list_dm</span><span class="p">]</span>

    <span class="n">et_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">et_list</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_subs_list_tp</span><span class="p">]</span>
    <span class="n">et_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">et_list</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bad_subs_list_dm</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">individual_series</span><span class="p">(</span><span class="n">peer_list</span><span class="p">,</span> <span class="n">et_list</span><span class="p">):</span>

        <span class="n">et_series</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">peer_series</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">peer_list</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/no_gsr_train1_tp_pred.csv&#39;</span><span class="p">)</span>
                <span class="n">sub_x</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span>
                <span class="n">sub_y</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>

                <span class="n">peer_series</span><span class="p">[</span><span class="n">sub</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">sub_x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">sub_y</span><span class="p">}</span>

            <span class="k">except</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error with subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">et_list</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>
                <span class="n">sub_x</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span>
                <span class="n">sub_y</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>

                <span class="n">et_series</span><span class="p">[</span><span class="n">sub</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">sub_x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">sub_y</span><span class="p">}</span>

            <span class="k">except</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error with subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">et_series</span><span class="p">,</span> <span class="n">peer_series</span>

    <span class="k">def</span> <span class="nf">med_series</span><span class="p">(</span><span class="n">peer_list</span><span class="p">,</span> <span class="n">et_list</span><span class="p">):</span>
        <span class="c1"># peer_list = subjects with valid peer scans</span>
        <span class="c1"># et_list = subjects with valid et data</span>

        <span class="n">et_series</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="n">peer_series</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="p">[]}</span>

        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">peer_list</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/no_gsr_train1_tp_pred.csv&#39;</span><span class="p">)</span>
                <span class="n">sub_x</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span>
                <span class="n">sub_y</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub_x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">250</span><span class="p">:</span>
                    <span class="n">peer_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sub_x</span><span class="p">))</span>
                    <span class="n">peer_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sub_y</span><span class="p">))</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>

            <span class="k">except</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error with subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">et_list</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>
                <span class="n">sub_x</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">]</span>
                <span class="n">sub_y</span> <span class="o">=</span> <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">]</span>
                <span class="n">et_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sub_x</span><span class="p">))</span>
                <span class="n">et_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sub_y</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>

                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error with subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>

        <span class="n">et_mean_series</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">et_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">et_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)}</span>
        <span class="n">peer_mean_series</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">peer_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">peer_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)}</span>

        <span class="k">return</span> <span class="n">et_mean_series</span><span class="p">,</span> <span class="n">peer_mean_series</span>

    <span class="n">et_individual_series</span><span class="p">,</span> <span class="n">peer_individual_series</span> <span class="o">=</span> <span class="n">individual_series</span><span class="p">(</span><span class="n">sub_list</span><span class="p">,</span> <span class="n">et_list</span><span class="p">)</span>
    <span class="n">et_mean_series</span><span class="p">,</span> <span class="n">peer_mean_series</span> <span class="o">=</span> <span class="n">med_series</span><span class="p">(</span><span class="n">sub_list</span><span class="p">,</span> <span class="n">et_list</span><span class="p">)</span>
    
    <span class="n">pd_et</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">et_mean_series</span><span class="p">)</span>
    <span class="n">pd_peer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">peer_mean_series</span><span class="p">)</span>
    <span class="n">pd_et</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/et_group_median.csv&#39;</span><span class="p">)</span>
    <span class="n">pd_peer</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/peer_group_median.csv&#39;</span><span class="p">)</span>

    <span class="n">no_z_x</span> <span class="o">=</span> <span class="n">spearmanr</span><span class="p">(</span><span class="n">peer_mean_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">et_mean_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">no_z_y</span> <span class="o">=</span> <span class="n">spearmanr</span><span class="p">(</span><span class="n">peer_mean_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">et_mean_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">x_axis</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">peer_mean_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Median fixation series for ET and PEER&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">peer_mean_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;PEER, r=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">no_z_x</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">et_mean_series</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ET&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="p">:])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">peer_mean_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;PEER, r=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">no_z_y</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">et_mean_series</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ET&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">75</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/manuscript_figures/eeg_peer_comp.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>






<span class="c1">###########</span>

<div class="viewcode-block" id="fig_two_old"><a class="viewcode-back" href="../source/manuscript_figures.html#manuscript_figures.fig_two_old">[docs]</a><span class="k">def</span> <span class="nf">fig_two_old</span><span class="p">():</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">)</span>

    <span class="n">viewtype</span> <span class="o">=</span> <span class="s1">&#39;calibration&#39;</span>
    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;peer&#39;</span>
    <span class="n">cscheme</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span>
    <span class="n">sorted_by</span> <span class="o">=</span> <span class="s1">&#39;age&#39;</span>

    <span class="n">x_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_stack</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sorted_by</span><span class="p">])</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">filename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_calibration_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
                     <span class="s1">&#39;tp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
                     <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}}</span>

    <span class="n">fixations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;stim_vals.csv&#39;</span><span class="p">)</span>
    <span class="n">x_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_x&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fixations</span><span class="p">[</span><span class="s1">&#39;pos_y&#39;</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]))</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_targets</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_targets</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>
        
    <span class="n">x_hm</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_hm</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>

                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error processing subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>            
            
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_targets</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_targets</span><span class="p">)</span>

    <span class="n">x_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_stack</span><span class="p">)</span>
    <span class="n">y_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">y_stack</span><span class="p">)</span>

    <span class="n">x_spacing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_hm</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>





    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=.</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Calibration Scan Predictions&#39;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">x_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_spacing</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Subjects&#39;</span><span class="p">)</span>

<span class="c1">#    plt.subplot(grid[:2, 2:])</span>
<span class="c1">#    plt.title(&#39;Calibration Predictions in y-&#39;)</span>
<span class="c1">#    ax = sns.heatmap(y_hm, cmap=cscheme, xticklabels=False, yticklabels=False)</span>
<span class="c1">#    ax.set(xlabel=&#39;Volumes&#39;, ylabel=&#39;Subjects&#39;)</span>
<span class="c1">#    ax.xaxis.set_major_formatter(ticker.FormatStrFormatter(&#39;%d&#39;))</span>
<span class="c1">#    ax.xaxis.set_major_locator(ticker.MultipleLocator(base=np.round(x_spacing/5, 0)))</span>



    <span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/phenotypes_full.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">)</span>

    <span class="n">viewtype</span> <span class="o">=</span> <span class="s1">&#39;dm&#39;</span>
    <span class="n">modality</span> <span class="o">=</span> <span class="s1">&#39;peer&#39;</span>
    <span class="n">cscheme</span> <span class="o">=</span> <span class="s1">&#39;inferno&#39;</span>
    <span class="n">sorted_by</span> <span class="o">=</span> <span class="s1">&#39;Scan1_meanfd&#39;</span>

    <span class="n">x_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_stack</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">sorted_by</span><span class="p">])</span>
    <span class="n">sub_list</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    
    <span class="n">qap_mri</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/home/json/Desktop/peer/qap_naturalistic_mri.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">subject</span><span class="p">)</span>
    
    <span class="n">sub_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sub_list</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">qap_mri</span><span class="p">]</span>

    <span class="n">filename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;calibration&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_calibration_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">},</span>
                     <span class="s1">&#39;tp&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_tp_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">},</span>
                     <span class="s1">&#39;dm&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;/gsr0_train1_model_dm_predictions.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;num_vol&#39;</span><span class="p">:</span> <span class="mi">750</span><span class="p">}}</span>
    
    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]))</span>
    <span class="n">arrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
    <span class="n">arry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">monitor_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span>
        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">sub_list</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;peer&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">modality</span> <span class="o">==</span> <span class="s1">&#39;et&#39;</span><span class="p">:</span>

                <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="s1">&#39;/data2/Projects/Jake/Human_Brain_Mapping/&#39;</span> <span class="o">+</span> <span class="n">sub</span> <span class="o">+</span> <span class="s1">&#39;/et_device_pred.csv&#39;</span><span class="p">)</span>

            <span class="n">x_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;x_pred&#39;</span><span class="p">])</span>
            <span class="n">y_series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;y_pred&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">filename_dict</span><span class="p">[</span><span class="n">viewtype</span><span class="p">][</span><span class="s1">&#39;num_vol&#39;</span><span class="p">]):</span>

                <span class="n">x_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_width</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_width</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_series</span><span class="p">]</span>
                <span class="n">y_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">monitor_height</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="o">.</span><span class="mi">1</span><span class="o">*</span><span class="n">monitor_height</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y_series</span><span class="p">]</span>

                <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_series</span><span class="p">)</span>
                <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_series</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error processing subject &#39;</span> <span class="o">+</span> <span class="n">sub</span><span class="p">)</span>
    
    <span class="n">avg_series_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">avg_series_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_stack</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">03</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrx</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arry</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">avg_series_x</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">avg_series_y</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_list</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">05</span><span class="p">,</span> <span class="mi">0</span><span class="p">))):</span>
        <span class="n">x_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_series_x</span><span class="p">)</span>
        <span class="n">y_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_series_y</span><span class="p">)</span>

    <span class="n">x_hm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">x_stack</span><span class="p">)</span>

    <span class="n">x_spacing</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_hm</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>




    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="p">:])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Despicable Me Predictions&#39;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">x_hm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cscheme</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Subjects&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Volumes&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x_spacing</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="c1">#plt.savefig(&#39;/home/json/Desktop/manuscript_figures/fig2.png&#39;, dpi=600)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>







    
    
    
    
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Jake Jungwoo Son.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>